# 需要考虑的场景和边界情况

## 1. 用户体验场景

### 1.1 题目上传场景

#### ✅ 已考虑
- 手机拍照上传（1-5张图片）
- 添加可选说明文字
- 图片排序

#### 🤔 还需考虑

**场景：图片质量问题**
- ❓ 图片模糊、角度歪斜怎么办？
  - 建议：提供图片编辑功能（旋转、裁剪、亮度调整）
  - MVP: 允许删除重拍
  
**场景：图片过大**
- ❓ 用户拍摄的原图可能很大（5-10MB）
  - 建议：前端压缩后再上传
  - 后端限制单张图片最大10MB

**场景：上传失败**
- ❓ 网络不好，上传到一半失败了
  - 建议：保存草稿，允许续传
  - MVP: 显示友好错误提示，允许重试

**场景：误删除题目**
- ❓ 用户不小心删除了重要题目
  - 建议：软删除（标记为已删除，30天后真正删除）
  - 或：删除前需要确认

**场景：批量上传**
- ❓ 用户有50道题目要上传
  - 建议：支持批量上传模式
  - MVP: 逐个上传即可

---

### 1.2 题目浏览场景

#### 🤔 需要考虑

**场景：海量题目**
- ❓ 用户上传了1000道题目，列表页怎么展示？
  - 建议：虚拟滚动、分页加载
  - 提供更强大的筛选和搜索

**场景：找不到题目**
- ❓ 用户记不清上传的题目在哪里
  - 建议：搜索功能（按标签、日期、科目）
  - 最近查看、收藏功能

**场景：题目预览**
- ❓ 列表页只显示缩略图，无法判断是哪道题
  - 建议：hover显示说明文字
  - 显示上传日期、标签信息

---

### 1.3 答题场景

#### 🤔 需要考虑

**场景：答题被中断**
- ❓ 用户答题到一半，手机没电或被打断
  - 建议：自动保存草稿
  - 下次打开可以继续

**场景：答案很长**
- ❓ 数学题解题步骤很多
  - 建议：支持富文本编辑（加粗、下划线、换行）
  - 或支持上传答题过程的图片

**场景：多次答题**
- ❓ 用户对同一道题答题3次
  - 建议：显示历史答题记录
  - 可对比多次答案

**场景：答案批改**
- ❓ 谁来判断答案对错？
  - MVP: 学生自己标记对/错
  - 未来: 导师可以点评

---

### 1.4 学习统计场景

#### 🤔 需要考虑

**场景：统计不准确**
- ❓ 学生乱标记对错，统计数据失真
  - 建议：导师可以纠正标记
  - 显示"学生自评"vs"导师评价"

**场景：跨设备同步**
- ❓ 学生在手机上传题目，在电脑上答题
  - 建议：云端同步，实时更新
  - MVP已支持（都是访问同一API）

**场景：离线使用**
- ❓ 没有网络时想复习题目
  - 建议：PWA离线缓存
  - 未来功能

---

## 2. 数据管理场景

### 2.1 数据完整性

**场景：题目内容为空**
- ❓ 用户只上传了说明文字，没有图片
  - 建议：前端验证，至少需要1张图片
  - 后端也要验证

**场景：图片链接失效**
- ❓ Cloudinary误删除了图片，链接404
  - 建议：定期检查图片可用性
  - 备份重要数据

**场景：重复题目**
- ❓ 用户不小心上传了相同的题目
  - 建议：图片相似度检测（未来）
  - MVP: 允许重复，用户自己管理

---

### 2.2 数据迁移

**场景：从其他平台导入**
- ❓ 用户在其他地方有题库，想批量导入
  - 建议：提供导入功能（CSV、Excel）
  - 未来功能

**场景：导出数据**
- ❓ 用户想备份自己的题目
  - 建议：提供导出为PDF功能
  - 或打包下载所有图片

---

## 3. 多用户协作场景

### 3.1 家长-学生关系

**场景：家长查看学生进度**
- ❓ 家长如何关联学生账号？
  - 建议：学生发送邀请码，家长输入绑定
  - 或：注册时填写家长邮箱

**场景：多个孩子**
- ❓ 家长有2个孩子在用平台
  - 建议：家长可以切换查看不同孩子
  - Dashboard显示所有孩子概览

**场景：隐私保护**
- ❓ 学生不想让家长看到某些题目（太简单/太难）
  - 建议：题目可以设置为"仅自己可见"
  - 或家长只能看统计，不能看具体题目

---

### 3.2 导师-学生关系

**场景：导师批量管理学生**
- ❓ 导师有30个学生，如何管理？
  - 建议：学生列表、批量操作
  - 按学生分组

**场景：导师添加讲解**
- ❓ 导师讲解的格式？
  - 建议：支持文字+图片+视频链接
  - MVP: 纯文字即可

**场景：导师分享题目**
- ❓ 导师想把优质题目分享给所有学生
  - 建议：题目库共享功能
  - 学生可以"复制到我的题库"

---

### 3.3 题目分享场景

**场景：分享给多个人**
- ❓ 学生想把题目分享给同学和导师
  - 建议：一次选择多个接收者
  - 或生成分享链接（有效期7天）

**场景：分享权限**
- ❓ 被分享的人可以编辑题目吗？
  - 建议：只读分享 vs 可编辑分享
  - MVP: 只读即可

**场景：批量分享**
- ❓ 分享10道相似的题目
  - 建议：题目集合功能
  - 创建"代数专题"集合，一次分享整个集合

---

## 4. 安全和权限场景

### 4.1 账号安全

**场景：密码忘记**
- ❓ 学生忘记密码无法登录
  - 必须：邮箱重置密码功能
  - 或手机验证码

**场景：账号被盗**
- ❓ 有人登录了学生账号，删除了题目
  - 建议：登录日志、异常检测
  - 可恢复最近删除的题目

**场景：未成年人保护**
- ❓ 平台有未成年用户
  - 建议：符合儿童在线隐私保护法
  - 需要家长同意（如适用）

---

### 4.2 数据隐私

**场景：数据泄露**
- ❓ 数据库被黑，学生题目泄露
  - 必须：HTTPS加密传输
  - 数据库访问控制
  - 定期安全审计

**场景：GDPR合规**
- ❓ 如果有欧洲用户
  - 必须：数据删除权、导出权
  - 隐私政策和条款

---

### 4.3 内容审核

**场景：不当内容**
- ❓ 用户上传不适当的图片
  - 建议：举报功能
  - 管理员审核

**场景：版权问题**
- ❓ 用户上传有版权的题目（如真题）
  - 建议：用户协议说明责任
  - 仅个人学习使用

---

## 5. 性能和扩展性场景

### 5.1 性能场景

**场景：加载慢**
- ❓ 用户网络慢，图片加载很久
  - 建议：渐进式加载（先缩略图后高清）
  - lazy loading
  - 图片优化（WebP格式）

**场景：同时上传**
- ❓ 100个用户同时上传图片
  - 建议：队列处理
  - Cloudinary CDN自动处理

**场景：数据库查询慢**
- ❓ 题目数达到10万+
  - 建议：合理的数据库索引
  - 缓存热点数据（Redis）

---

### 5.2 扩展性场景

**场景：用户量激增**
- ❓ 从100用户增长到10000用户
  - 建议：水平扩展（增加服务器）
  - PlanetScale自动扩展
  - Vercel/Railway自动扩展

**场景：存储空间不足**
- ❓ Cloudinary免费额度用完
  - 建议：升级付费计划
  - 或迁移到其他存储（S3）

---

## 6. 边界和异常情况

### 6.1 输入验证

**必须验证的输入**
- ❌ 科目名称不在允许列表中
- ❌ 难度不是1-5
- ❌ 标签数量超过10个
- ❌ 说明文字超过1000字
- ❌ 图片不是图片格式
- ❌ 单张图片超过10MB

**示例**：
```python
# 后端验证
if subject not in VALID_SUBJECTS:
    return error('Invalid subject')

if difficulty < 1 or difficulty > 5:
    return error('Difficulty must be 1-5')

if len(tags) > 10:
    return error('Maximum 10 tags')

if len(description) > 1000:
    return error('Description too long')
```

---

### 6.2 错误处理

**场景：Cloudinary上传失败**
```python
try:
    result = cloudinary.uploader.upload(file)
except Exception as e:
    # 记录日志
    logger.error(f'Cloudinary upload failed: {e}')
    # 返回友好错误
    return jsonify({'error': 'Image upload failed, please try again'}), 500
```

**场景：数据库连接失败**
```python
try:
    db.session.commit()
except Exception as e:
    db.session.rollback()
    logger.error(f'Database error: {e}')
    return jsonify({'error': 'Failed to save question'}), 500
```

---

## 7. 用户引导和帮助

### 7.1 首次使用

**场景：新用户不知道怎么用**
- 建议：首次登录显示引导教程
- "上传你的第一道题目"step-by-step
- 或提供demo题目

### 7.2 帮助文档

**建议提供**
- FAQ（常见问题）
- 视频教程（如何上传题目）
- 联系支持（问题反馈）

---

## 8. 通知和提醒

### 8.1 复习提醒

**场景：学生忘记复习**
- ❓ 推荐的题目一直不做
  - 建议：邮件提醒
  - 或App推送通知（PWA）
  - 设置个性化提醒时间

### 8.2 导师反馈通知

**场景：导师添加了讲解**
- ❓ 学生不知道有新评论
  - 建议：站内通知
  - 邮件通知（可配置）

---

## 9. 移动端特殊场景

### 9.1 手机兼容性

**场景：不同手机品牌**
- iOS Safari vs Android Chrome
- 相机权限获取
- 图片格式差异（HEIC等）

**建议**：
- 充分测试不同设备
- 提供降级方案

### 9.2 网络环境

**场景：移动网络vs WiFi**
- 4G/5G上传可能很慢
- 建议：显示上传进度
- 允许后台上传

---

## 10. 未来扩展场景

### 10.1 AI功能

**场景：OCR识别题目文字**
- 用户拍照后，自动识别文字
- 可以搜索题目内容

**场景：AI批改**
- 数学题自动判断对错
- 给出详细解析

### 10.2 社区功能

**场景：题目市场**
- 用户分享优质题目
- 下载别人的题目集合

**场景：排行榜**
- 答题数量排名
- 正确率排名
- 激励学习

---

## 11. 优先级建议

### P0 - MVP必须考虑
- ✅ 输入验证（前后端）
- ✅ 错误处理和友好提示
- ✅ 基本的用户权限（只能看自己的题目）
- ✅ 图片大小限制
- ✅ 删除确认

### P1 - MVP后立即补充
- ⭐ 密码重置功能
- ⭐ 软删除（误删恢复）
- ⭐ 图片编辑（旋转、裁剪）
- ⭐ 家长-学生关联

### P2 - Phase 2考虑
- 📌 批量上传
- 📌 题目集合
- 📌 数据导出
- 📌 更强大的搜索

### P3 - 长期规划
- 🔮 AI功能
- 🔮 社区功能
- 🔮 离线模式

---

## 总结

### 关键要点

1. **MVP聚焦核心**：能上传、能复习、有推荐
2. **优雅降级**：功能缺失时有友好提示
3. **数据安全**：验证、权限、备份
4. **用户体验**：快速、简单、符合直觉
5. **可扩展**：架构支持未来功能

### 建议的开发顺序

Week 1-7: MVP核心功能
- 专注：上传、浏览、答题、推荐

Week 8-10: 安全和体验
- 补充：权限、验证、错误处理、删除恢复

Week 11+: 扩展功能
- 添加：高级功能、AI、社区

**这样是否全面？有没有遗漏的重要场景？** 🤔
